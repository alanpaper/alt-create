### 产品命名为 **TerminalReader**。

---

### 一、产品愿景与核心原则

1.  **愿景**：为喜欢在终端环境下工作或阅读的技术爱好者、开发者、极客用户，提供一个纯粹、高效、可定制且不伤眼的ePub阅读工具。
2.  **核心原则**：
    *   **键盘驱动**：完全通过键盘快捷键操作，流畅且高效。
    *   **极简专注**：界面极致简洁，最大化内容展示区域，减少干扰。
    *   **可定制化**：允许用户自定义主题、字体、快捷键等。
    *   **尊重终端特性**：利用终端色彩、粗体等有限样式提升体验，但不强求图形化。

---

### 二、用户交互流程与功能详述

#### 场景一：启动与打开书籍

1.  **启动**：
    *   用户在终端输入命令 `terminalreader` 启动应用。
    *   或者直接指定ePub文件路径启动：`terminalreader path/to/your/book.epub`。

2.  **初始界面（书架视图）**：
    *   如果启动时不带参数，应用会显示一个简单的**本地书架**。
    *   书架列出最近阅读的书籍（存储阅读进度）和已添加到书架的书籍。
    *   **交互**：
        *   使用 `j`/`k` 或 `↑`/`↓` 键在书列表中选择书籍。
        *   `Enter` 打开选中的书籍。
        *   `a` 键可以添加新的ePub文件到书架。
        *   `d` 键可以从书架中删除选中的书籍（确认机制：弹出“确认删除？”提示，按 `y` 或 `n`）。
        *   `q` 退出应用。

#### 场景二：阅读视图

这是最核心的界面。

1.  **布局**：
    ```
    《书籍标题》 - 《当前章节标题》         [进度：55%] [电量：82%] (可选)
    ────────────────────────────────────────────────────────────────────────────────
    （这里是正文内容，精心排版，适应终端宽度，自动换行）

    （支持简单的文本样式，如加粗、斜体（用颜色或下划线替代））

    （支持图片？可选功能：尝试用ASCII Art或外部图片查看器链接显示）
    ────────────────────────────────────────────────────────────────────────────────
    [第 15 页] | [章节目录] | [帮助：?]
    ```
    *   **顶部状态栏**：显示书名、章节名、阅读进度、系统状态（时间、电量）。
    *   **中部内容区**：核心阅读区域。
    *   **底部状态栏/导航栏**：显示当前页码（或位置）、快速跳转章节目录的入口、帮助入口。

2.  **核心阅读交互**：
    *   `空格键` 或 `f`：**向下翻页**。
    *   `b`：**向上翻页**。
    *   `→`/`l`：**下一节**（可能跳转到下一章）。
    *   `←`/`h`：**上一节**（可能跳转到上一章）。
    *   `g`：**跳转**。按下后底部状态栏变为输入模式：
        *   `g 15` → 跳转到第15页。
        *   `g 50%` → 跳转到书籍的50%位置。
        *   `g c3` → 跳转到第3章。
    *   `/`：**搜索**。按下后进入搜索模式，输入关键词后按回车，使用 `n`/`N` 跳转到下一个/上一个匹配结果。
    *   `m`：**添加书签**。为当前页添加书签。
    *   `M`：**查看书签列表**。从列表中可以跳转到任一书签。

3.  **导航与菜单**：
    *   `T`：**显示章节目录**。会弹出一个层叠窗口，列出所有章节，使用方向键选择并按 `Enter` 跳转。
    *   `?`：**显示帮助**。弹出所有快捷键的说明窗口。
    *   `c`：**自定义设置**。弹出设置菜单，可以临时更改：
        *   主题（亮色/暗色/自定义）
        *   字体大小（增大/减小/重置）
        *   自动换行（开启/关闭）
    *   `q`：**退出**。在阅读视图中，按一次 `q` 会退回**书架视图**。在书架视图再按一次 `q` 才会退出应用。防止误操作。

#### 场景三：设置与个性化

1.  **配置文件**：
    *   在 `~/.config/terminalreader/` 目录下生成配置文件 `config.toml`。
2.  **可配置项**：
    *   `theme`: “dark” (默认) 或 “light”，定义背景和文字颜色。
    *   `font_size`: 终端字体大小由终端本身控制，但可以配置行间距或缩进。
    *   `keybindings`: 允许高级用户重映射快捷键。
    *   `default_view`: 启动后默认进入“阅读视图”还是“书架视图”。
    *   `image_handler`: 定义如何显示图片，例如 `"ascii"` 或 `"feh"` (调用外部工具)。

---

### 三、技术考量与非功能性需求

1.  **性能**：解析ePub和渲染文本需要快速响应，翻页无延迟感。
2.  **兼容性**：
    *   支持ePub 2.0 和 3.0 标准。
    *   兼容主流终端：iTerm2 (macOS), GNOME Terminal (Linux), Windows Terminal (Win10/11)。
3.  **错误处理**：
    *   无法解析的ePub文件应给出友好错误提示，而非崩溃。
    *   快捷键冲突时应有提示。
4.  **辅助功能**：
    *   考虑支持屏幕阅读器（虽然终端本身支持有限）。

---

### 四、MVP (最小可行产品) 范围

为了快速迭代和发布，第一期版本聚焦核心功能：

1.  **基本阅读**：打开ePub文件、翻页、跳转章节。
2.  **核心快捷键**：翻页（空格/b）、跳章（→/←）、帮助（?）、退出（q）。
3.  **状态显示**：显示书名、章节名、进度。
4.  **暗色主题**。

**第二期迭代**再加入书架管理、搜索、书签、自定义设置等高级功能。

---

### 总结

TerminalReader 的交互设计紧紧围绕**键盘、效率、简洁**这三个核心。它不是一个功能臃肿的软件，
而是一个为特定环境和特定用户群打造的专注工具。通过清晰的界面布局、直观的快捷键设计和可扩展的架构，它能为用户在终端中带来沉浸且舒适的阅读体验。




#### 规划
1. 添加reader 子命令
- 开始阅读 添加书 删除书
2. 添加主循环 
- 选择具体书后 进入主循环
- 在主循环 最上方是 书的当前页内容
- 在下方用户可以选择 上一页 下一页 退出
- 获取使用命令进行翻页操作 